package com.supinfo.suptravel.dao;

import javax.persistence.EntityManager;
import javax.persistence.Persistence;
import javax.persistence.Query;

import org.hibernate.HibernateException;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.Transaction;
import org.hibernate.cfg.Configuration;
 
import com.supinfo.suptravel.bean.User;

public class TripDAO {

    public Long getNumberTrip() {
    	EntityManager entityManager = Persistence.createEntityManagerFactory("SupTravel").createEntityManager();
        Long countuser = (Long) entityManager.createQuery("select count (id) from Trip").getSingleResult();
        entityManager.close();
        return countuser;
    }
    
    public int logIn(String name, String password) {
    	EntityManager entityManager = Persistence.createEntityManagerFactory("SupTravel").createEntityManager();
    	String spassword = null;
    	try {
	        spassword = (String) entityManager.createQuery("select password from User where name=:name").setParameter("name",name).getSingleResult();
	        System.out.println(spassword + "/////////" + password);
	        if (spassword != null && spassword.equals(password)) {
	        	int id = -9999;
	        	id = (int) entityManager.createQuery("select id from User where name=:name").setParameter("name",name).getSingleResult();
	        	return id;
	        }
	        return -9999;
    	} catch (Exception e) {
    		System.out.println(e.getMessage());
            System.out.println("Fatal");
            return -9999;
    	}
    }
}
